@import finitio/data
#definition of the JSon input format in finitio: http://www.finitio.io/

HardwareModel = {
    name:String
    powerCap:?Integer
    energyCap:?Integer
    processingElementClasses:[ProcessingElementClass]
    processingElements:[ProcessingElement]
    busses:[Bus]
    properties:[NameValue]
}

ProcessingElement = {
    processorClass:ProcessingElementClassRef
    name:String
    memSize:Integer
    resources:[NameValue]
    properties:[NameValue]
    powerModel:Formula
}

Bus = {halfDuplexBus:HalfDuplexBus}

HalfDuplexBus = {
    name:String
    relatedProcessors:[ProcessingElementRef]
    timeUnitPerBit:Integer
    latency:Integer
}

#referencing a processing element that is declared in HardwareModel/processingElements
ProcessingElementRef = String

NameValue = {
    name:String
    value:Integer
}

ProcessingElementClass =
    {monoTaskSwitchingTask:MonoTaskSwitchingTaskClass}
    | {multiTaskPermanentTasks:MultiTaskPermanentTasksClass}

MonoTaskSwitchingTaskClass = {
    name:String
    resources:[String]
    properties:[String]
    switchingDelay:?Integer
}

MultiTaskPermanentTasksClass ={
    name:String
    resources:[String]
    properties:[String]
}

SoftwareModel =  {
    simpleProcesses:[SimpleProcess]
    transmissions:[Transmission]
    softwareClass:SoftwareClass
}

SimpleProcess = {
    name:String
    implementations:[Implementation]
}

Implementation = {
    name:String
    target:ProcessingElementClassRef
    parameters:[ParameterDefinition]
    resourceUsage:[NameFormula]
    computationMemory:Formula
    duration:Formula
}

NameFormula = {
    name:String
    formula:Formula
}

#referencing a processing element class that is declared in HardwareModel/processingElementClasses
ProcessingElementClassRef = String

Formula = String

ParameterDefinition = {
    name:String
    values:[Integer]
}

Transmission = {
    name:String
    source:SimpleProcessRef
    target:SimpleProcessRef
    size:Integer
    timing:TransmissionTimingConstraint
}

#Asap,Free,Alap
TransmissionTimingConstraint = String

SimpleProcessRef = String

SoftwareClass =
    {iterativeSoftware:IterativeSoftware}
    | {oneShotSoftware:OneShotSoftware}

IterativeSoftware={
    maxFrameDelay:?Integer
    maxMakespan:?Integer
}

OneShotSoftware = {
    maxDelay:?Integer
}

MappingGoal =
    {multiObjective:MultiObjectiveGoal}
    | {simpleObjective:SimpleGoal}

#minMakeSpan,minEnergy,minFrame
SimpleGoal = String

MultiObjectiveGoal = {
    a:SimpleGoal
    b:SimpleGoal
}

Main = {
    hardwareModel:HardwareModel
    softwareModel:SoftwareModel
    goal:MappingGoal
}
